<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Reset Password â€” Orion GLE Ltd</title>
<meta name="robots" content="noindex,nofollow">
<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
<style>
:root{--bg:#05070d;--text:#fff;--muted:rgba(255,255,255,.72);--line:rgba(255,255,255,.1);--a1:#7c3aed;--a2:#22d3ee}
*{box-sizing:border-box}body{margin:0;min-height:100vh;display:grid;place-items:center;padding:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text)}
.card{width:min(520px,100%);border:1px solid var(--line);border-radius:16px;background:rgba(255,255,255,.03);padding:22px}
h1{margin:0 0 8px;font-size:32px}p{margin:0 0 14px;color:var(--muted)}
label{display:block;font-size:13px;color:rgba(255,255,255,.8);margin-top:10px}
input{width:100%;margin-top:6px;padding:11px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:#fff}
button{margin-top:14px;width:100%;padding:12px;border:none;border-radius:12px;font-weight:700;background:linear-gradient(135deg,var(--a1),var(--a2));color:#061019;cursor:pointer}
.status{margin-top:10px;min-height:20px;color:#ff9aa2;font-size:13px}
.links{margin-top:12px;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}.links a{color:#fff;text-decoration:none;border-bottom:1px dotted rgba(255,255,255,.35);font-size:13px}
</style>
</head><body>
<div class="card">
  <h1>Reset Password</h1>
  <p>Set a new password for your portal account.</p>
  <form id="resetForm">
    <label>New password<input id="password" type="password" minlength="8" required></label>
    <label>Confirm password<input id="confirm" type="password" minlength="8" required></label>
    <button type="submit">Update password</button>
    <p class="status" id="status"></p>
  </form>
  <div class="links"><a href="/portal/login.html">Back to login</a><a href="/contact.html">Need help?</a></div>
</div>
<script>
const params = new URLSearchParams(window.location.search);
const token = params.get('token') || '';
const statusEl = document.getElementById('status');

if (!token) {
  statusEl.textContent = 'Reset token is missing.';
}

document.getElementById('resetForm').addEventListener('submit', async function(e){
  e.preventDefault();
  if (!token) return;
  const password = document.getElementById('password').value;
  const confirm = document.getElementById('confirm').value;
  if (password.length < 8) {
    statusEl.textContent = 'Password must be at least 8 characters.';
    return;
  }
  if (password !== confirm) {
    statusEl.textContent = 'Passwords do not match.';
    return;
  }

  statusEl.textContent = 'Updating password...';
  try {
    const res = await fetch('/api/auth/reset-password', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ token, password })
    });
    const data = await res.json().catch(()=>({}));
    if (!res.ok) throw new Error(data.error || 'Unable to reset password');
    statusEl.style.color = '#7ef0a8';
    statusEl.textContent = 'Password updated. Redirecting to login...';
    setTimeout(function(){
      window.location.assign('/portal/login.html');
    }, 1200);
  } catch (err) {
    statusEl.textContent = err.message || 'Unable to reset password';
  }
});
</script>
</body></html>
